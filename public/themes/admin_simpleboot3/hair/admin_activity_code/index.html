<include file="public@header"/>
</head>
<body>
<div class="wrap">
    <ul class="nav nav-tabs">
        <li class="active"><a href="{:url('AdminActivityCode/index')}">激活码管理</a></li>
        <li><a href="{:url('AdminActivityCode/generate')}">生成一级激活码</a></li>
    </ul>
    <form class="well form-inline margin-top-20" method="post" action="{:url('AdminActivityCode/index')}">
        激活码:
        <input type="text" class="form-control" name="code" style="width: 150px;" value="{:input('param.code/s','')}" placeholder="请输入激活码">
        级别：
        <select class="form-control" name="level" style="width: 140px;">
            <foreach name="Think.config.property.code_level" item="vo">
                <php>$target_selected=input('request.level',999)==$key?"selected='selected'":"";</php>
                <option value="{$key}" {$target_selected}>{$vo}</option>
            </foreach>
        </select>
        是否绑定：
        <select class="form-control" name="is_bind" style="width: 140px;">
            <foreach name="Think.config.property.bind_select" item="vo">
                <php>$target_selected=input('request.is_bind',999)==$key?"selected='selected'":"";</php>
                <option value="{$key}" {$target_selected}>{$vo}</option>
            </foreach>
        </select>
        <input type="hidden" name="parent_id" value="{:input('param.parent_id/s','')}">
        <input type="submit" class="btn btn-primary" value="搜索"/>
        <a class="btn btn-danger" href="{:url('AdminActivityCode/index')}">清空</a>
    </form>
    <form method="post" class="js-ajax-form">
        <table class="table table-hover table-bordered table-list">
            <thead>
            <tr>
                <th width="50">ID</th>
                <th>父级激活码</th>
                <th>用户</th>
                <th>激活码</th>
                <th>验证码</th>
                <th>级别</th>
                <th>下级数量</th>
                <th>分配比率</th>
                <th>引用次数</th>
                <th>生成时间</th>
                <th width="150">操作</th>
            </tr>
            </thead>
            <tbody>
            <foreach name="codes" item="vo">
                <tr>
                    <td>{$vo.id}</td>
                    <td><a href="{:url('AdminActivityCode/index',['parent_id'=>$vo.parent_id])}">{$vo.parent_code}</a></td>
                    <td>{$vo.user_name_str}</td>
                    <td>{$vo.code}</td>
                    <td>{$vo.verify}</td>
                    <td>{$vo.level_str}</td>
                    <td><a href="{:url('AdminActivityCode/index',['parent_id'=>$vo.id])}">{$vo.child_num_str}</a></td>
                    <td>
                        <php>$str=$vo['level']==1?$vo['rate'].'% '.$vo['rate2'].'%':$vo['rate'].'%'</php>
                        {$str}
                    </td>
                    <td>{$vo.count}</td>
                    <td>{$vo.create_time_str}</td>
                    <td>
                        <a href='{:url("AdminActivityCode/edit",array("id"=>$vo["id"]))}'>{:lang('EDIT')}</a>
                        <eq name="vo['level']" value="1">
                            <a href='{:url("AdminActivityCode/generate",array("parent_id"=>$vo["id"]))}'>生成二级激活码</a>
                        </eq>
                    </td>
                </tr>
            </foreach>
            </tbody>
        </table>
        <div class="pagination">{$page}</div>
    </form>
</div>
<script src="__STATIC__/js/admin.js"></script>
</body>
</html>